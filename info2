private object? ConvertTextToType(string text, Type targetType)
{
    try
    {
        if (targetType == typeof(string))
            return text;

        if (string.IsNullOrWhiteSpace(text))
            return null;

        // Handle nullable types
        Type baseType = Nullable.GetUnderlyingType(targetType) ?? targetType;

        return Convert.ChangeType(text, baseType);
    }
    catch
    {
        return null;
    }
}
