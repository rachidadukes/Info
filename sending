Find this part in Sending (inside the Try):

hostAdaptor = LoadHostAdapter(sHostAdapterAssembly)

sSendMsg = sSendMsg.Replace("&amp;", "&").Replace("&lt;", "<").Replace("&gt;", ">").Replace("&quot;", Chr(34))
Dim sSendTime As String = Now.ToString("MM/dd/yyyy HH:mm:ss.ffff")
hostStatus = hostAdaptor.SendAndReceive(sSendMsg, sRecvMsg)
Dim sRecvTime As String = Now.ToString("MM/dd/yyyy HH:mm:ss.ffff")

If sTrace.ToLower = "sendonly" Then
    sTraceLog = String.Format("Send to Host; len={1}{0}{2}{3}", sSendTime, sSendMsg.Length & " ", vbCrLf, sSendMsg)

ElseIf sTrace.ToLower = "receiveonly" Then
    sTraceLog &= String.Format("Receive from Host; len={1}{0}{2}{3}", sRecvTime, sRecvMsg.Length & " ", vbCrLf, sRecvMsg)

ElseIf sTrace.ToLower = "sendandreceive" Then
    sTraceLog = String.Format("Send to Host; len={1}{0}{2}{3}", sSendTime, sSendMsg.Length & " ", vbCrLf, sSendMsg)
    If sSendMsg.Length + sRecvMsg.Length > TraceMaxLogLen Then
        RaiseEvent LogError(msDBID, Left(sTraceLog, TraceMaxLogLen), "Trace to/from Host")
        sTraceLog = ""
    Else
        sTraceLog &= vbCrLf
    End If
    sTraceLog &= String.Format("Receive from Host; len={1}{0}{2}{3}", sRecvTime, sRecvMsg.Length & " ", vbCrLf, sRecvMsg)
End If

If sTraceLog.Length > 0 Then
    RaiseEvent LogError(msDBID, sTraceLog, "Trace to/from Host")
End If


Delete that whole If sTrace.ToLower = ... block and the If sTraceLog.Length > 0 right below it, and replace with:

' Build trace using the helper (success path)
sTraceLog = BuildTraceLog(sTrace, _
                          "Send to Host", _
                          "Receive from Host", _
                          sSendTime, _
                          sRecvTime, _
                          sSendMsg, _
                          sRecvMsg, _
                          False)   ' isError = False

If sTraceLog.Length > 0 AndAlso _
   Not sTrace.Equals("none", StringComparison.OrdinalIgnoreCase) Then

    RaiseEvent LogError(msDBID, sTraceLog, "Trace to/from Host")
End If


Everything else in the Try (loading adapter, setting hostStatus, the If hostStatus = ... Then Return True) stays the same.

2. Error path changes in Sending (Catch block)

In your Catch ex As Exception you currently have something like:

Catch ex As Exception
    Dim sErrSource As String = String.Empty
    Dim sErrMessage As String

    If sTrace.ToLower = "sendonly" Then
        If Not sSendMsg Is Nothing Then
            sTraceLog = String.Format("Send to Host; len={0};{1}{2}", sSendMsg.Length, vbCrLf, sSendMsg)
        End If
    ElseIf sTrace.ToLower = "receiveonly" Then
        If Not sRecvMsg Is Nothing Then
            sTraceLog = String.Format("Receive from Host; len={0};{1}{2}", sRecvMsg.Length, vbCrLf, sRecvMsg)
        End If
    ElseIf sTrace.ToLower = "sendandreceive" Then
        If Not sSendMsg Is Nothing Then
            sTraceLog = String.Format("Send to Host; len={0};{1}{2}", sSendMsg.Length, vbCrLf, sSendMsg)
            sTraceLog &= vbCrLf
        End If
        If Not sRecvMsg Is Nothing Then
            sTraceLog &= String.Format("Receive from Host; len={0};{1}{2}", sRecvMsg.Length, vbCrLf, sRecvMsg)
        End If
    End If

    If sTraceLog.Length > 0 Then
        RaiseEvent LogError(msDBID, Left(sTraceLog, 6000), "Trace to/from Host")
    End If

    sErrSource = String.Format("{0}.{1}/{2}", Me.GetType, methodTag, ex.Source)
    RaiseEvent LogError(msDBID, ex.Message, sErrSource)

    sErrMessage = ex.Message
    Dim objNew As New Exception(sErrMessage) With {.Source = sErrSource}
    Throw objNew
End Try


Again, remove the If sTrace.ToLower block and the If sTraceLog.Length > 0 right under it, and replace that part with:

Catch ex As Exception
    Dim sErrSource As String = String.Empty
    Dim sErrMessage As String

    ' Build trace using helper (error path – no timestamps, isError = True)
    sTraceLog = BuildTraceLog(sTrace, _
                              "Send to Host", _
                              "Receive from Host", _
                              Nothing, _
                              Nothing, _
                              sSendMsg, _
                              sRecvMsg, _
                              True)

    If sTraceLog.Length > 0 AndAlso _
       Not sTrace.Equals("none", StringComparison.OrdinalIgnoreCase) Then

        RaiseEvent LogError(msDBID, Left(sTraceLog, 6000), "Trace to/from Host")
    End If

    sErrSource = String.Format("{0}.{1}/{2}", Me.GetType, methodTag, ex.Source)
    RaiseEvent LogError(msDBID, ex.Message, sErrSource)

    sErrMessage = ex.Message
    Dim objNew As New Exception(sErrMessage) With {.Source = sErrSource}
    Throw objNew
End Try


That’s it:
