using Microsoft.Extensions.Configuration;
using System.IO;

namespace MemberSearchConsoleApp
{
    public static class ConfigHelper
    {
        public static AppSettings LoadAppSettings()
        {
            var config = new ConfigurationBuilder()
                .SetBasePath(Directory.GetCurrentDirectory())
                .AddJsonFile("appsettings.json", optional: false, reloadOnChange: true)
                .Build();

            return new AppSettings
            {
                MessageConverterUrl = config["Endpoints:MessageConverter"] ?? "",
                TimeoutSeconds = int.TryParse(config["Http:TimeoutSeconds"], out var t) ? t : 30,
                ForceTranCode = bool.TryParse(config["Testing:ForceTranCode"], out var f) && f,
                ForceTranCodeValue = config["Testing:TranCode"] ?? "1001"
            };
        }
    }
}
