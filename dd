private static async Task<string> RouteRequestAsync(
    string soapXml,
    string apiUrl,
    AppSettings settings)
{
    if (MessageRouter.ShouldRouteToST(soapXml))
    {
        return await MessageRouter.SendToSTAsync(
            soapXml,
            settings.MessageConverterUrl,
            settings.TimeoutSeconds,
            settings.ForceTranCode,
            settings.ForceTranCodeValue);
    }

    var legacy = new MemberSearchXMLresponse();
    return await legacy.ReadXMLresponse(soapXml, apiUrl);
}
