Imports System.Net.Http
Imports System.Text
' ...

' Reuse ONE HttpClient for the app
Private Shared ReadOnly httpClient As New HttpClient With {
    .Timeout = TimeSpan.FromSeconds(30)
}

' ... inside your legacy sync method:
Using content As New StringContent(xml, Encoding.UTF8, "application/xml")
    Dim body As String =
        Task.Run(Async Function()
                     Dim resp As HttpResponseMessage =
                         Await httpClient.PostAsync(endpointUrl, content).ConfigureAwait(False)

                     Dim txt As String =
                         Await resp.Content.ReadAsStringAsync().ConfigureAwait(False)

                     If Not resp.IsSuccessStatusCode Then
                         Throw New HttpRequestException($"[{ROUTINE}] Error {CInt(resp.StatusCode)}: {txt}")
                     End If

                     Return txt
                 End Function).
        GetAwaiter().GetResult()

    response = body
End Using

