
// Optionally inspect REST payload for logical errors
if (resp.IsSuccessStatusCode)
{
    // some REST APIs return 200 but have "error" fields in the JSON/XML
    if (result.ResponseBody.Contains("\"error\"") ||
        result.ResponseBody.Contains("\"errorCode\"") ||
        result.ResponseBody.Contains("<Error>") ||
        result.ResponseBody.Contains("<Fault>"))
    {
        result.Error = "Logical API error found in body despite HTTP 200";
    }
}
else
{
    // If non-2xx, synthesize an error message (keep body for diagnostics)
    result.Error = $"HTTP {(int)resp.StatusCode} {resp.ReasonPhrase}";
}
