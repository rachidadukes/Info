

✅ Step 1. Test reachability from PowerShell

Run these in a PowerShell window (not Visual Studio):

Resolve-DnsName swydcdvencaej01.nfcu.net
Test-NetConnection swydcdvencaej01.nfcu.net -Port 443


❌ If either fails → you’re not on your corporate VPN or internal network.
→ Connect to the VPN first.

✅ If both succeed → the host is reachable; continue below.

✅ Step 2. Check server certificate trust
curl -vk https://swydcdvencaej01.nfcu.net


Look for:

SSL certificate problem: unable to get local issuer certificate → your workstation doesn’t trust the server’s internal CA.
→ Ask IT for the root and intermediate certificates, then import them to:

LocalMachine\Trusted Root Certification Authorities

LocalMachine\Intermediate Certification Authorities

Once imported, your code will succeed.

✅ Step 3. Verify correct host (SNI)

Your client certificate CN is:

CN=LTCC483A490BE4.nfcu.net


but your URL host is:

swydcdvencaej01.nfcu.net


If the server only accepts requests via its CN host, try changing:

private const string ApiUrl = "https://LTCC483A490BE4.nfcu.net/EncoreCore/api/MessageConverter/ConvertMessage";


Then re-run the probe.

✅ Step 4. Confirm TLS version

The code already enforces SslProtocols.Tls12.
If your network enforces TLS 1.3 only, add it:

SslProtocols = SslProtocols.Tls12 | SslProtocols.Tls13

✅ Step 5. (Optional) Print TLS handshake details

Add inside your ServerCertificateCustomValidationCallback:

Console.WriteLine($"[TLS] ServerCert: {cert?.Subject}");
Console.WriteLine($"[TLS] Errors: {errors}");


Run again — if you see RemoteCertificateChainErrors, it’s definitely trust-chain.

🚀 Summary
Root Cause	Fix
🔒 Not on VPN	Connect to internal network
🧾 Internal CA not trusted	Import CA chain to LocalMachine Root/CA
🌐 Wrong host/SNI	Use URL https://LTCC483A490BE4.nfcu.net/...
⚙️ TLS mismatch	Add Tls13 to SslProtocols

Once you run the curl or Test-NetConnection tests, paste me the output — I’ll tell you exactly which of those four is the culprit and the next single-line fix to make your probe succeed.
