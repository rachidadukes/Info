samples

private static X509Certificate2? LoadClientCertificate()
{
    var configuration = new ConfigurationBuilder()
        .SetBasePath(AppContext.BaseDirectory)
        .AddJsonFile("appsettings.json", optional: false, reloadOnChange: true)
        .Build();

    var subjectName = configuration["HostSettings:ClientCert:SubjectName"];
    var storeLocationStr = configuration["HostSettings:ClientCert:StoreLocation"];
    var storeNameStr = configuration["HostSettings:ClientCert:StoreName"];

    // Convert string values to enums with safe fallbacks
    if (!Enum.TryParse(storeLocationStr, ignoreCase: true, out StoreLocation storeLoc))
        storeLoc = StoreLocation.LocalMachine;

    if (!Enum.TryParse(storeNameStr, ignoreCase: true, out StoreName storeName))
        storeName = StoreName.My;

    // Try load cert
    var cert = CertificateLoader.LoadFromStore(subjectName, storeLoc, storeName);

    if (cert == null)
        Console.WriteLine($"⚠️ Certificate '{subjectName}' not found in {storeLoc}\\{storeName}");

    return cert;
}
