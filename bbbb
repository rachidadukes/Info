public static bool CopySingleTable(
    string sourceDbPath,
    string destinationDbPath,
    string tableName,
    out string errorMessage)
{
    errorMessage = string.Empty;

    try
    {
        if (!File.Exists(sourceDbPath))
            throw new FileNotFoundException("Source DB not found.", sourceDbPath);

        if (!File.Exists(destinationDbPath))
            throw new FileNotFoundException("Destination DB not found.", destinationDbPath);

        SqliteConnection.ClearAllPools();

        var srcConnString = new SqliteConnectionStringBuilder
        {
            DataSource = sourceDbPath,
            Mode       = SqliteOpenMode.ReadOnly
        }.ToString();

        var destConnString = new SqliteConnectionStringBuilder
        {
            DataSource = destinationDbPath
        }.ToString();

        using var src  = new SqliteConnection(srcConnString);
        using var dest = new SqliteConnection(destConnString);

        src.Open();
        dest.Open();

        using var tx = dest.BeginTransaction();

        var safeTable = tableName.Replace("\"", "\"\"");

        // 1) Clear destination table
        using (var delCmd = dest.CreateCommand())
        {
            delCmd.Transaction = tx;
            delCmd.CommandText = $@"DELETE FROM ""{safeTable}"";";
            delCmd.ExecuteNonQuery();
        }

        // 2) Read from source and insert into dest
        using (var selCmd = src.CreateCommand())
        {
            selCmd.CommandText = $@"SELECT * FROM ""{safeTable}"";";
            using var reader = selCmd.ExecuteReader();

            // Build INSERT based on column names
            var columnNames = Enumerable.Range(0, reader.FieldCount)
                                        .Select(reader.GetName)
                                        .ToArray();

            var cols  = string.Join(",", columnNames.Select(n => $@"""{n}"""));
            var parms = string.Join(",", columnNames.Select((n, i) => $"@p{i}"));

            using var insCmd = dest.CreateCommand();
            insCmd.Transaction = tx;
            insCmd.CommandText = $@"INSERT INTO ""{safeTable}"" ({cols}) VALUES ({parms});";

            while (reader.Read())
            {
                insCmd.Parameters.Clear();
                for (int i = 0; i < reader.FieldCount; i++)
                {
                    var value = reader.IsDBNull(i) ? DBNull.Value : reader.GetValue(i);
                    insCmd.Parameters.AddWithValue($"@p{i}", value);
                }

                insCmd.ExecuteNonQuery();
            }
        }

        tx.Commit();
        return true;
    }
    catch (Exception ex)
    {
        errorMessage = $"Error while copying table '{tableName}': {ex.Message}";
        return false;
    }
}



=========================
string error;
bool ok1 = SqliteLogCopier.CopySingleTable(
    @"C:\Path\SQLiteLogs.db",
    @"C:\Path\SQLiteLogsTransactions.db",
    "LogDetails",
    out error);

if (!ok1) { MessageBox.Show(error); return; }

bool ok2 = SqliteLogCopier.CopySingleTable(
    @"C:\Path\SQLiteLogs.db",
    @"C:\Path\SQLiteLogsTransactions.db",
    "RequestResponse",
    out error);

if (!ok2) { MessageBox.Show(error); return; }

MessageBox.Show("Tables copied successfully.");

