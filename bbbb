using Microsoft.Data.Sqlite;
using System;
using System.IO;

public static class SqliteLogCopier
{
    /// <summary>
    /// Copies all rows from LogDetails in sourceDbPath to LogDetails in destinationDbPath.
    /// Destination table is emptied first.
    /// Returns true on success; false on error and sets errorMessage.
    /// </summary>
    public static bool CopyLogDetails(
        string sourceDbPath,
        string destinationDbPath,
        out string errorMessage)
    {
        errorMessage = string.Empty;

        try
        {
            if (!File.Exists(sourceDbPath))
                throw new FileNotFoundException("Source DB not found.", sourceDbPath);

            if (!File.Exists(destinationDbPath))
                throw new FileNotFoundException("Destination DB not found.", destinationDbPath);

            var destConnString = new SqliteConnectionStringBuilder
            {
                DataSource = destinationDbPath
            }.ToString();

            using var connection = new SqliteConnection(destConnString);
            connection.Open();

            using var transaction = connection.BeginTransaction();
            using var cmd = connection.CreateCommand();
            cmd.Transaction = transaction;

            cmd.CommandText = @"
                ATTACH DATABASE $srcPath AS SrcDb;

                DELETE FROM LogDetails;

                INSERT INTO LogDetails
                SELECT *
                FROM SrcDb.LogDetails;

                DETACH DATABASE SrcDb;
            ";

            cmd.Parameters.AddWithValue("$srcPath", sourceDbPath);

            cmd.ExecuteNonQuery();
            transaction.Commit();

            return true;
        }
        catch (FileNotFoundException ex)
        {
            errorMessage = $"File not found: {ex.FileName}";
            return false;
        }
        catch (SqliteException ex)
        {
            // Any SQLite-specific issues (locking, SQL error, etc.)
            errorMessage = $"SQLite error while copying LogDetails: {ex.Message}";
            return false;
        }
        catch (Exception ex)
        {
            // Anything unexpected
            errorMessage = $"Unexpected error while copying LogDetails: {ex.Message}";
            return false;
        }
    }
}





========================


string error;
bool ok = SqliteLogCopier.CopyLogDetails(
    @"C:\Path\To\SQLiteLogs.db",
    @"C:\Path\To\SQLiteLogsTransactions.db",
    out error);

if (!ok)
{
    // In WPF you might show a MessageBox, log, etc.
    MessageBox.Show(error, "Copy LogDetails Failed");
}

