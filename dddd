private static X509Certificate2? FindValidCertificateByThumbprint(string subjectName)
{
    X509Certificate2? certificate;

    using (X509Store store = new("Remote Desktop", StoreLocation.LocalMachine))
    {
        store.Open(OpenFlags.ReadOnly);

        X509Certificate2Collection certificates = store.Certificates;

        certificate = certificates
            .Cast<X509Certificate2>()
            .FirstOrDefault();
    }

    return certificate;
}

