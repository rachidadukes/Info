If Not resp.IsSuccessStatusCode Then
        Throw New HttpRequestException(
            $"HTTP {(CInt(resp.StatusCode))} ({resp.ReasonPhrase}). Body={response}")
    End If

Catch ex As AggregateException
    Dim root = ex.Flatten().InnerExceptions(0) ' usually the real one

    ' optional: drill to innermost
    While root.InnerException IsNot Nothing
        root = root.InnerException
    End While

    Throw New Exception($"Request failed. Root={root.GetType().FullName}: {root.Message}", ex)
End Try
