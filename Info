WITH Ranked AS (
    SELECT 
        Id,
        AccountNumber,
        AccessNumber,
        TRIM(LOWER(AccountType)) AS NormalizedAccountType,
        Environment,
        ROW_NUMBER() OVER (
            PARTITION BY AccountNumber, AccessNumber, TRIM(LOWER(AccountType)), Environment
            ORDER BY Id
        ) AS RowNum
    FROM AccessAcctNumbers
)
SELECT 
    Id,
    AccountNumber,
    AccessNumber,
    NormalizedAccountType AS AccountType,
    Environment
FROM Ranked
WHERE RowNum > 1
ORDER BY AccountNumber;
