using System.Text.RegularExpressions;

public List<AccountModel> ReadAcctListDetail(RequestResponseLogModel log)
{
    var accountsList = new List<AccountModel>();
    var input = log.FullMessage;

    // Pattern to match blocks like <AcctKeys><AcctId>...</AcctId><AcctType>...</AcctType></AcctKeys>
    var acctKeyPattern = new Regex(
        @"<AcctKeys>\s*<AcctId>(?<acctId>.*?)<\/AcctId>\s*<AcctType>(?<acctType>.*?)<\/AcctType>\s*<\/AcctKeys>",
        RegexOptions.Singleline | RegexOptions.IgnoreCase);

    foreach (Match match in acctKeyPattern.Matches(input))
    {
        var acctId = match.Groups["acctId"].Value;
        var acctType = match.Groups["acctType"].Value;

        var model = new AccountModel
        {
            EventID = log.EventID,
            DateTimeStamp = log.DateTimeStamp,
            AccountNumber = acctId,
            AcctType = acctType
        };

        accountsList.Add(model);
    }

    return accountsList;
}
