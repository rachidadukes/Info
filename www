Imports System
Imports System.Threading.Tasks

Module Program

    Async Function Main(args As String()) As Task
        Try
            Dim request As String = RequestWithGLAcct.BuildXmlRequest()

            Dim objNewAPI As New ApiXmlClient()
            Dim response As String = Await objNewAPI.GetResponseFromNewAPI(request)

            AnsiConsole.MarkupLine("[bold red]Request:[/]")
            AnsiConsole.WriteLine()
            XmlStringFormatter.BeautifyXmlString(request)

            Console.WriteLine()
            Console.WriteLine()

            AnsiConsole.MarkupLine("[bold red]Response:[/]")
            AnsiConsole.WriteLine()
            XmlStringFormatter.BeautifyXmlString(response)

        Catch ex As Exception
            Console.WriteLine($"Error Rest Response: {ex.Message}")
        End Try
    End Function

End Module
